<html>

<head>
</head>

<script>

var myscan;
var myflag = 0;

function doScan()
{
   var xhr;
   var params = "0";
   xhr = new XMLHttpRequest();
   xhr.onreadystatechange = handleStateChange;
   xhr.open("POST", '/checkscan/', true);
   xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
   xhr.setRequestHeader("Content-length", params.length);
   xhr.setRequestHeader("Connection", "close");
   xhr.send(params);
   function handleStateChange() {
       if (xhr.readyState == 4 &&  xhr.status == 200) {
           if (xhr.responseText == 'G') {
               if (myflag == 0) {
                   myscan = window.setInterval(getNode, 1000);
                   myflag = 1;
               }
           }
           if (xhr.responseText == 'S') {
               window.clearInterval(myscan);
               myflag = 0;
           }
       }
   }
}


function getNode()
{
   doScan();

   var xhr;
   var params = "0";
   xhr = new XMLHttpRequest();
   xhr.onreadystatechange = handleStateChange;
   xhr.open("POST", '/refreshnode/', true);
   xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
   xhr.setRequestHeader("Content-length", params.length);
   xhr.setRequestHeader("Connection", "close");
   xhr.send(params);
   function handleStateChange() {
       if (xhr.readyState == 4 &&  xhr.status == 200) {
           var element = document.getElementById('textblock');
           element.innerHTML = xhr.responseText;
       }
   }

}

function setCV()
{
   var cvaddr = document.getElementById('cvaddr').value;
   var cvdata = document.getElementById('cvdata').value;
   var macadd = document.getElementById('address').value;

   var xhr;
   var params = "cvaddr="+cvaddr+"&cvdata="+cvdata+"&address="+macadd;
   xhr = new XMLHttpRequest();
   xhr.onreadystatechange = handleStateChange;
   xhr.open("POST", '/setcv/', true);
   xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
   xhr.setRequestHeader("Content-length", params.length);
   xhr.setRequestHeader("Connection", "close");
   xhr.send(params);
   function handleStateChange() {
       if (xhr.readyState == 4 &&  xhr.status == 200) {
           //var element = document.getElementById('textblock');
           //element.innerHTML = xhr.responseText;
       }
   }

}






function setHome()
{
   window.location.href = "/";
}

</script>

<style>

.rcr {
  font-family: Arial;
  border-radius: 25px;
  border: 1px solid black;
  background: #bbbbbb;
  padding: 20px;
  width: 300px;
  height: 400px;
}

.myButton {
	-moz-box-shadow:inset 0px 1px 0px 0px #ffffff;
	-webkit-box-shadow:inset 0px 1px 0px 0px #ffffff;
	box-shadow:inset 0px 1px 0px 0px #ffffff;
	background:-webkit-gradient(linear, left top, left bottom, color-stop(0.05, #ededed), color-stop(1, #dfdfdf));
	background:-moz-linear-gradient(top, #ededed 5%, #dfdfdf 100%);
	background:-webkit-linear-gradient(top, #ededed 5%, #dfdfdf 100%);
	background:-o-linear-gradient(top, #ededed 5%, #dfdfdf 100%);
	background:-ms-linear-gradient(top, #ededed 5%, #dfdfdf 100%);
	background:linear-gradient(to bottom, #ededed 5%, #dfdfdf 100%);
	filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#ededed', endColorstr='#dfdfdf',GradientType=0);
	background-color:#ededed;
	-moz-border-radius:6px;
	-webkit-border-radius:6px;
	border-radius:6px;
	border:1px solid eeeeee;
	display:inline-block;
	cursor:pointer;
	color:#555555;
	font-family:Arial;
	font-size:15px;
	font-weight:bold;
	padding:6px 24px;
	text-decoration:none;
	text-shadow:0px 1px 0px #ffffff;
}

.theButton {
        background-color:#ededed;
        -moz-border-radius:6px;
        -webkit-border-radius:6px;
        border-radius:6px;
        border:1px solid eeeeee;
        height:34px;
//        display:inline-block;
        cursor:pointer;
        color:#555555;
        font-family:Arial;
        font-size:15px;
        font-weight:bold;
        padding:0px 14px;
        text-decoration:none;
        text-shadow:0px 1px 0px #ffffff;
}
</style>


<body>

  <div class=rcr>
    <div style="font-size:24px;text-align:center">{{ name }}</div>
    <div style="font-size:14px;text-align:center">{{ address }}</div>
    <input type="hidden" id="address" value="{{address}}">

    <div style="margin:30px;"></div>

    <div id="textblock" style="margin: 0 auto;">
            &nbsp;
    </div>

</body>
<script>
window.onload = getNode();
window.onload = doScan();
</script>
</html>
